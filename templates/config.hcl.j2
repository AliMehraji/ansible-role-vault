{{ ansible_managed | comment }}

cluster_name = "{{ vault_cluster_name }}"
max_lease_ttl = "{{ vault_max_lease_ttl }}"
default_lease_ttl = "{{ vault_default_lease_ttl }}"

disable_clustering = "{{ vault_disable_clustering }}"
{% if vault_cluster_addr is defined %}
cluster_addr = "{{ vault_cluster_addr }}"
{% endif %}

api_addr = "{{ vault_api_addr }}"

plugin_directory = "/usr/local/lib/vault/plugins"

{% if vault_ui is defined and vault_ui %}
ui = true
{% endif %}

{% for storage in vault_storages %}
storage "{{ storage.name }}" {
  path    = "{{ storage.path }}"
  node_id = "{{ storage.node_id }}"
{% if storage.retry_join is defined %}{% for member in storage.retry_join %}
  retry_join {
    leader_api_addr="{{ member }}"
  }
{% endfor %}{% endif %}
}
{% endfor %}

{% for listener in vault_listeners %}
listener "{{ listener.name }}" {
  address     = "{{ listener.address }}"
  tls_disable = {{ listener.tls_disable }}
}
{% endfor %}

api_addr = "{{ vault_api_addr }}"

{% if vault_cluster_addr is defined %}
cluster_addr = "{{ vault_cluster_addr }}"
{% endif %}

disable_mlock = {{ vault_disable_mlock }}
